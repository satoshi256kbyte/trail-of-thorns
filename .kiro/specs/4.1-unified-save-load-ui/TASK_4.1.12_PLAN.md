# タスク4.1.12: アニメーション・エフェクトの実装 - 実装計画

## 現状分析

### ✅ 既に実装済みのアニメーション

1. **SaveSlotButton** (`game/src/ui/SaveSlotButton.ts`)
   - ホバー時のスケールアニメーション（1.02倍）
   - フォーカス時のオーバーレイフェードイン/アウト

2. **NavigableMenuButton** (`game/src/ui/NavigableMenuButton.ts`)
   - フォーカス時のオーバーレイフェードイン/アウト（200ms）
   - アクティベーション時のスケールアニメーション（0.95倍、100ms、yoyo）

3. **ConfirmationDialog** (`game/src/ui/ConfirmationDialog.ts`)
   - ダイアログ表示時のフェードイン（200ms）
   - パネルのスケールアップ（0.8→1.0、200ms、Back.easeOut）
   - ダイアログ非表示時のフェードアウト（150ms）

4. **ErrorMessage** (`game/src/ui/ErrorMessage.ts`)
   - 非表示時のフェードアウト（300ms）

### ❌ 未実装のアニメーション

1. **スロット選択時のより目立つアニメーション**
   - 現在: 選択状態の色変更のみ
   - 必要: スケールアップ効果、選択枠のフェードイン

2. **ローディング表示**
   - 現在: なし
   - 必要: スピナーアニメーション、「処理中...」テキスト

3. **成功メッセージのスライドインアニメーション**
   - 現在: 即座に表示/非表示
   - 必要: スライドイン効果

4. **エラーメッセージのシェイク効果**
   - 現在: フェードアウトのみ
   - 必要: シェイク効果

## 実装計画

### サブタスク4.1.12.1: スロット選択時のアニメーション強化

**対象ファイル**: `game/src/ui/SaveSlotButton.ts`

**実装内容**:
- `setSelected()`メソッドにアニメーション追加
- 選択時: スケールアップ（1.0→1.05、200ms）
- 選択解除時: スケールダウン（1.05→1.0、200ms）
- 選択枠のフェードイン/アウト（既存のフォーカスオーバーレイを活用）

**推定工数**: 30分

---

### サブタスク4.1.12.2: ボタンホバー時のアニメーション（確認）

**対象ファイル**: `game/src/ui/NavigableMenuButton.ts`

**実装内容**:
- 既存実装を確認
- 必要に応じて色変更アニメーションを追加

**推定工数**: 15分（確認のみ）

---

### サブタスク4.1.12.3: ローディング表示コンポーネントの作成

**新規ファイル**: `game/src/ui/LoadingSpinner.ts`

**実装内容**:
- `LoadingSpinner`クラスを作成（Phaser.GameObjects.Container継承）
- 回転するスピナーグラフィック
- 「処理中...」テキスト表示
- フェードイン/アウトアニメーション
- 自動回転アニメーション（360度、1000ms、無限ループ）

**推定工数**: 1時間

---

### サブタスク4.1.12.4: SaveLoadSceneへのローディング表示統合

**対象ファイル**: `game/src/scenes/SaveLoadScene.ts`

**実装内容**:
- `LoadingSpinner`のインポート
- セーブ・ロード・削除操作時にローディング表示
- 操作完了後にローディング非表示
- `executeSaveOperation()`, `executeLoadOperation()`, `executeDeleteOperation()`メソッドに統合

**推定工数**: 45分

---

### サブタスク4.1.12.5: 成功メッセージのスライドインアニメーション

**対象ファイル**: `game/src/scenes/SaveLoadScene.ts`

**実装内容**:
- `showMessage()`メソッドにスライドインアニメーション追加
- 画面上部から下にスライドイン（y: -50 → 150、300ms、Back.easeOut）
- フェードアウト時は上にスライドアウト（y: 150 → -50、300ms）

**推定工数**: 30分

---

### サブタスク4.1.12.6: エラーメッセージのシェイク効果

**対象ファイル**: `game/src/ui/ErrorMessage.ts`

**実装内容**:
- コンストラクタにシェイクアニメーション追加
- 表示時に左右にシェイク（x: -10 → 10 → -10 → 10 → 0、400ms、3回繰り返し）
- エラータイプのみシェイク（警告・情報はシェイクなし）

**推定工数**: 30分

---

### サブタスク4.1.12.7: パフォーマンステスト

**新規ファイル**: `tests/performance/SaveLoadSceneAnimationPerformance.test.ts`

**実装内容**:
- アニメーション実行中のフレームレート測定
- 60fps維持の確認
- 複数アニメーション同時実行時のパフォーマンステスト

**推定工数**: 1時間

---

## 実装順序

1. **サブタスク4.1.12.1**: スロット選択時のアニメーション強化（30分）
2. **サブタスク4.1.12.2**: ボタンホバー時のアニメーション確認（15分）
3. **サブタスク4.1.12.3**: ローディング表示コンポーネントの作成（1時間）
4. **サブタスク4.1.12.4**: SaveLoadSceneへのローディング表示統合（45分）
5. **サブタスク4.1.12.5**: 成功メッセージのスライドインアニメーション（30分）
6. **サブタスク4.1.12.6**: エラーメッセージのシェイク効果（30分）
7. **サブタスク4.1.12.7**: パフォーマンステスト（1時間）

**合計推定工数**: 約5時間

---

## 受け入れ基準

- [x] スロット選択時にスケールアップアニメーションが表示される
- [x] ボタンホバー時にアニメーションが表示される（既存実装確認）
- [x] セーブ・ロード・削除実行時にローディング表示が出る
- [x] 成功メッセージがスライドインで表示される
- [x] エラーメッセージにシェイク効果が追加される
- [x] ダイアログの表示アニメーションが動作する（既存実装確認）
- [x] 全アニメーション実行中に60fpsを維持する

---

## 次のステップ

この実装計画を確認し、承認いただければ、サブタスク4.1.12.1から順次実装を開始します。

各サブタスクの実装完了後、テストを実行して動作確認を行います。
